<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Students</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">
    <h2 class="mb-4 text-center">Student List</h2>

    <table class="table table-bordered table-striped">
        <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Batch</th>
            <th>GPA</th>
        </tr>
        </thead>
        <tbody id="studentTableBody">
        </tbody>
    </table>

    <div class="d-flex justify-content-center">
        <button class="btn btn-secondary me-2" onclick="prevPage()">Previous</button>
        <button class="btn btn-secondary" onclick="nextPage()">Next</button>
    </div>
</div>

<script>
    let page = 0;
    const size = 5;

    function loadStudents() {
        fetch(`/api/students?page=${page}&size=${size}&sortBy=id`)
            .then(response => {
                if (!response.ok) {
                    throw new Error("Not authorized");
                }
                return response.json();
            })
            .then(data => {
                const tbody = document.getElementById("studentTableBody");
                tbody.innerHTML = "";

                data.content.forEach(student => {
                    const row = `
                        <tr>
                            <td>${student.id}</td>
                            <td>${student.name}</td>
                            <td>${student.email}</td>
                            <td>${student.batch}</td>
                            <td>${student.gpa}</td>
                        </tr>
                    `;
                    tbody.innerHTML += row;
                });
            })
            .catch(error => {
                alert("Please login first!");
                window.location.href = "/login";
            });
    }

    function nextPage() {
        page++;
        loadStudents();
    }

    function prevPage() {
        if (page > 0) {
            page--;
            loadStudents();
        }
    }

    loadStudents();
</script>

</body>
</html>
